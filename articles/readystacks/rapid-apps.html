<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang='en-us' xml:lang='en' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='content-type' />
    <title>
      Rapid Application Deployment with Git
    </title>
    <meta content='&lt;%= @page.author %&gt;' name='author' />
    <link href='/css/blueprint/screen.css' media='screen, projection' rel='stylesheet' type='text/css' />
    <!--[if IE]>
      <link href='/css/blueprint/print.css' media='print' rel='stylesheet' type='text/css' />
    <![endif]-->
    <link href='/css/blueprint/ie.css' media='screen, projection' type='text/css' />
    <link href='/css/coderay.css' rel='stylesheet' type='text/css' />
    <link href='/css/site.css' media='screen, projection' rel='stylesheet' type='text/css' />
  </head>
  <body>
    <div id='main'>
      <div id='header'>
        <div class='inner'>
          <div class='right'>
            <form action='http://www.google.com/cse' id='cse-search-box' target='_blank'>
              Search:
              <br />
              <input name='cx' type='hidden' value='012923036574958016342:li5hnoda-l4' />
              <input name='ie' type='hidden' value='UTF-8' />
              <input name='q' size='28' />
              <input name='sa' type='submit' value='Go' />
              <input name='siteurl' type='hidden' value='www.gmodules.com/ig/ifr?url=http://www.google.com/cse/api/012923036574958016342/cse/li5hnoda-l4/gadget&amp;synd=open&amp;w=294&amp;h=41&amp;title=Webbynode+Guides&amp;border=%23ffffff%7C3px%2C1px+solid+%23999999&amp;source=http%3A%2F%2Fwww.gmodules.com%2Fig%2Fcreator%3Fhl%3Den%26url%3Dhttp%253A%252F%252Fwww.google.com%252Fcse%252Fapi%252F012923036574958016342%252Fcse%252Fli5hnoda-l4%252Fgadget' />
            </form>
          </div>
          <p class='title'>
            <a href='/'>
              Webbynode Guides
            </a>
          </p>
        </div>
      </div>
      <div class='article' id='content'>
        <div class='inner'>
          <h1>Rapid Application Deployment with Git</h1>&#x000A;<p>Our <em>Rapid Application Deployment</em> stack allows you to deploy any Rails or Rack application as easy as pushing a git change you made. You just have to install Webbynode&#8217;s gem and run a couple of commands, based on the same git workflow you&#8217;re used it.</p>&#x000A;<p>Once you submit your app for deployment, all the dirty work will be done behind the scenes for you.</p>&#x000A;<h2>Requirements</h2>&#x000A;<ul>&#x000A;	<li>Webbynode account <em>(don&#8217;t tell me!)</em></li>&#x000A;	<li>Unix-based system: Linux, Mac OS X, &#8230;, but <strong>not windows</strong> (yet)</li>&#x000A;	<li>Ruby, RubyGems, Rails. Yes, the full gang!</li>&#x000A;	<li>git</li>&#x000A;</ul>&#x000A;<h2>Preparation</h2>&#x000A;<p>In order to use the Rapid App Deployment, you have to redeploy your Webby with this stack, but this just has to be done once. After that, you&#8217;ll be able to add new apps on the fly, without loosing what&#8217;s already configured on your Webby.</p>&#x000A;<p>Here&#8217;s a step-by-step guide of the options you need to choose:</p>&#x000A;<h4>Choose the Rails ReadyStack</h4>&#x000A;<p><img src="images/rapidapp-step1.jpg"></p>&#x000A;<h4>Choose <em>WebServer and Proxy</em> and <em>Database Server</em></h4>&#x000A;<p>Right now both <em>Apache2</em> and <em>nginx</em> with <em>Passenger</em> are supported. Both databases &#8211; <em>MySQL</em> and <em>PostgreSQL</em> &#8211; are also supported.</p>&#x000A;<p><img src="images/rapidapp-step2.jpg"></p>&#x000A;<h4>Choose Rapid App Deployment option</h4>&#x000A;<p><img src="images/rapidapp-step3.jpg"></p>&#x000A;<h2>Configuration</h2>&#x000A;<p>There are a couple of configuration settings you can choose before deploying:</p>&#x000A;<p><img src="images/rapidapp-step4.jpg"></p>&#x000A;<h4>App Base Path</h4>&#x000A;<p>That&#8217;s the directory where all your apps will be deployed.</p>&#x000A;<p>Let&#8217;s say you deploy 3 applications, called <code>blog</code>, <code>todo</code> and <code>shopping_list</code>. Here&#8217;s how your Base Path folder structure will look like, assuming you kept the default value of <code>/var/rails</code>:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>var&#x000A; `- rails&#x000A;     |- blog&#x000A;     |- todo&#x000A;     `- shopping_list&#x000A;</pre>&#x000A;</div>&#x000A;<h4>Password for deploy user</h4>&#x000A;<p>This is the password you&#8217;ll have to type when deploying.</p>&#x000A;<p>An user called <code>git</code> is always created when installing the Rapid App stack. This option let&#8217;s you pick a password for this user.</p>&#x000A;<h4>Rack frameworks</h4>&#x000A;<p>Pick what Rack Frameworks RubyGems you want to install.</p>&#x000A;<p>If you&#8217;re planning on deploying some Sinatra, Ramaze, Rango or Merb apps, it may be a good idea to bootstrap your Webby with the corresponding gems. This way you avoid having to log into your Webby to install them. Choose as many as you want.</p>&#x000A;<h2>Bootstrapping</h2>&#x000A;<p>To bootstrap your first application, first you need to install Webbynode&#8217;s RubyGem:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ sudo gem install webbynode&#x000A;&#x000A;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-&#x000A;       Webbynode deployment gem &#x000A;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-&#x000A;&#x000A;This deployment engine is highly experimental and&#x000A;should be considered beta code for the time being.&#x000A;&#x000A;Commands:&#x000A;&#x000A;    webbynode init    Initializes the current app for deployment to a Webby&#x000A;    webbynode push    Deploys the current committed code to a Webby&#x000A;&#x000A;Successfully installed webbynode-0.1.2&#x000A;1 gem installed&#x000A;</pre>&#x000A;</div>&#x000A;<p>Once it&#8217;s done, you have to initialize your app. The first piece of information you&#8217;ll need for that is your Webby&#8217;s IP. If you don&#8217;t know it yet, go to Webbymanager and, once you login, you&#8217;ll find it next to your Webby&#8217;s name:</p>&#x000A;<p><img src="images/mywebbies-ip.jpg"></p>&#x000A;<p>Now that you know the IP, you need to know whether you want this application&#8217;s virtual host to respond to an already registered and configured domain or if you want to get a *.webbyapp.com subdomain (if you are in doubt, go with the second option). If you don&#8217;t have a domain, leave the second parameter blank below.</p>&#x000A;<p>Let&#8217;s say you have created a Rails app called <code>myapp</code>. If you don&#8217;t specify the domain name during initialization, your app will respond to http://myapp.webbyapp.com.</p>&#x000A;<p>Now run the command:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ cd ~/dev/myapp&#x000A;$ webbynode init 208.88.125.207&#x000A;Initializing deployment descriptor for myapp...&#x000A;Creating .gitignore file...&#x000A;Initializing git repository...&#x000A;</pre>&#x000A;</div>&#x000A;<p>If your application doesn&#8217;t have a git repo, we&#8217;ll create one for you. After that, we&#8217;ll create a new remote source for this new git repo called <code>webbynode</code> pointing to your Webby&#8217;s IP.</p>&#x000A;<p>However, if you app already has a git repo, we&#8217;ll just create the new remote as described above.</p>&#x000A;<p>And your app is now ready to be published.</p>&#x000A;<h2>Publishing</h2>&#x000A;<p>To publish your application all you need is to run the push command using the Webbynode gem:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ webbynode push&#x000A;Publishing myapp to Webbynode...&#x000A;mkdir: created directory `myapp'&#x000A;Counting objects: 86, done.&#x000A;Delta compression using up to 2 threads.&#x000A;Compressing objects: 100% (72/72), done.&#x000A;Writing objects: 100% (86/86), 82.72 KiB, done.&#x000A;Total 86 (delta 11), reused 0 (delta 0)&#x000A;Checked out master branch&#x000A;&#x000A;----------------------------&#x000A;  Webbynode git deployment &#x000A;----------------------------&#x000A;&#x000A;Deploying application myapp as myapp.webbyapp.com...&#x000A;Configuring Rails application...&#x000A;  =&gt; Configuring apache vHost...&#x000A;  =&gt; Configuring database...&#x000A;  =&gt; Configuring database.yml...&#x000A;  =&gt; Installing missing gems...&#x000A;  =&gt; Migrating database...&#x000A;/var/rails/myapp/.git&#x000A;&#x000A;Restarting apache...&#x000A;&#x000A;Setting up DNS...&#x000A;&#x000A;myapp deployed successfully.&#x000A;&#x000A;Created http://myapp.webbyapp.com/&#x000A;&#x000A;To git@208.88.125.207:myapp&#x000A; * [new branch]      master -&gt; master&#x000A;</pre>&#x000A;</div>&#x000A;<p>At this point you should be able to open your browser and visit http://myapp.webbyapp.com and get your Rails app default page.</p>&#x000A;<h2>Updating</h2>&#x000A;<p>To update an already published app, you just have to follow the git workflow. After your changes have been saved, you&#8217;ll have to commit them:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ git add .&#x000A;$ git commit -m &quot;My lovely changeset&quot;&#x000A;</pre>&#x000A;</div>&#x000A;<p>And then, again:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ webbynode push&#x000A;Publishing myapp to Webbynode...&#x000A;mkdir: created directory `myapp'&#x000A;Counting objects: 86, done.&#x000A;...&#x000A;</pre>&#x000A;</div>&#x000A;<p>And that&#8217;s it. The same process will happen again.</p>&#x000A;<p>This very same process can be done for Rack applications, as long as you have the necessary gems installed during the preparation of your Webby.</p>&#x000A;<h2><a name="troubleshooting"> </a>Troubleshooting</h2>&#x000A;<p><strong>Problem:</strong> I have deployed my application just fine but when I make changes and do a <code>webbynode push</code> nothing changes on the website.</p>&#x000A;<p><strong>Resolution:</strong></p>&#x000A;<p>Sometimes you may have forgotten to commit your changes and try a <code>webbynode push</code>.</p>&#x000A;<p>In order to make sure, try issuing the <code>git status</code> command. If you have made no changes since your last commit, here&#8217;s what you should see:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ git status&#x000A;# On branch master&#x000A;nothing to commit (working directory clean)&#x000A;</pre>&#x000A;</div>&#x000A;<p>However, if you find that you still have changes &#8211; and specially new files:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ git status&#x000A;# On branch master&#x000A;# Untracked files:&#x000A;#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)&#x000A;#&#x000A;#       this_is_a_new_file.txt&#x000A;nothing added to commit but untracked files present (use &quot;git add&quot; to track)&#x000A;</pre>&#x000A;</div>&#x000A;<p>If that&#8217;s your case, it&#8217;s just a matter of adding the new file and committing the change. You&#8217;ll see that after that you&#8217;ll <code>get nothing to commit</code>:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ git add .  &#x000A;&#x000A;$ git commit -m &quot;Added this_new_file&quot;&#x000A;[master d30cb5b] Added this_new_file&#x000A; 1 files changed, 1 insertions(+), 0 deletions(-)&#x000A; create mode 100644 this_is_a_new_file.txt&#x000A; &#x000A;$ git status&#x000A;# On branch master&#x000A;nothing to commit (working directory clean)&#x000A;</pre>&#x000A;</div>&#x000A;<p>Another <code>webbynode push</code> should take care of your problem.</p>&#x000A;<p>However, sometimes Apache (or nginx) can choke upon restarting. This problem is usually solved by logging into your Webby and manually restarting them:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>&#x000A;$ /etc/init.d/apache2 stop&#x000A;* Stopping web server apache2&#x000A;... waiting&#x000A;&#x000A;$ /etc/init.d/apache2 start&#x000A;* Starting web server apache2 &#x000A;</pre>&#x000A;</div>&#x000A;<p>or</p>&#x000A;<div class="CodeRay">&#x000A;<pre>&#x000A;$ /etc/init.d/nginx stop&#x000A;* Stopping Nginx Server...                     [ OK ]&#x000A; &#x000A;$ /etc/init.d/nginx start&#x000A;* Starting Nginx Server...                     [ OK ]&#x000A;</pre>&#x000A;</div>&#x000A;<p>If none of the above approaches solve your problem, log into your Webby, delete the app and start over (see next section for information about how to do it).</p>&#x000A;<hr/>&#x000A;<p><strong>Problem:</strong> After deploying a Rack application with <em>Sinatra / Merb / Ramaze / Rango</em> framework, my website doesn&#8217;t load.</p>&#x000A;<p><strong>Resolution:</strong></p>&#x000A;<p>This is usually caused because you don&#8217;t have a <code>public</code> directory inside your Rack app. In order to successfully deploy to Apache/nginx + Passenger, such folder is mandatory &#8211; as can be seen on the passenger docs <a href="http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_a_rack_based_ruby_application">here</a> and <a href="http://www.modrails.com/documentation/Users%20guide%20Nginx.html#deploying_a_rack_app">here</a>.</p>&#x000A;<p>Try adding the public folder (and any contents into it, so <code>git</code> allows you to commit a change) and pushing again.</p>&#x000A;<h2>Deleting apps</h2>&#x000A;<p>If by any chance you want to remove a running app, it&#8217;s just a matter of logging into your Webby and using the <code>delete_app</code> script, as illustrated here:</p>&#x000A;<div class="CodeRay">&#x000A;<pre>$ delete_app myapp&#x000A;This will delete your app myapp and restart Apache.&#x000A;Are you sure? (y/n) y&#x000A;Deleting app at /var/rails/myapp...&#x000A;Removing vHost for myapp (myapp.webbyapp.com)...&#x000A;Restarting Apache...&#x000A;</pre>&#x000A;</div>&#x000A;<p>And now, what you&#8217;re waiting for? Get on the deploy early bandwagon.</p>&#x000A;
          <div class='master-separator'>
            <div class='separator-wrapper'>
              <div class='separator-label'>Comments</div>
            </div>
          </div>
          <div id='disqus_thread'></div>
          <script src='http://disqus.com/forums/webbynodeguides/embed.js' type='text/javascript'></script>
          <noscript>
            <a href='http://disqus.com/forums/webbynodeguides/?url=ref'>
              View the discussion thread.
            </a>
          </noscript>
          <a class='dsq-brlink' href='http://disqus.com'>
            blog comments powered by
            <span class='logo-disqus'>
              Disqus
            </span>
          </a>
        </div>
      </div>
    </div>
    <div id='force'></div>
    <div id='footer'>
      <div class='inner'>
        Copyright &copy; 2010-2020 Webbynode
      </div>
    </div>
    <script type='text/javascript'>
      <![CDATA[
          (function() {
          var links = document.getElementsByTagName('a');
          var query = '?';
          for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
          query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&amp;';
          }
          }
          document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/webbynodeguides/get_num_replies.js' + query + '"></' + 'script>');
          })();
      ]]>
    </script>
    <script type='text/javascript'>
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type='text/javascript'>
      try {
      var pageTracker = _gat._getTracker("UA-12533000-1");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
